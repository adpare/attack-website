{"description": "Enterprise techniques used by UNC2452, ATT&CK group G0118 v1.0", "name": "UNC2452 (G0118)", "domain": "enterprise-attack", "versions": {"layer": "4.1", "attack": "8", "navigator": "4.1"}, "techniques": [{"score": 1, "techniqueID": "T1087", "showSubtechniques": false, "comment": "[UNC2452](https://attack.mitre.org/groups/G0118) obtained a list of users and their roles from an Exchange server using Get-ManagementRoleAssignment.(Citation: Volexity SolarWinds)"}, {"techniqueID": "T1098", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1098.002", "showSubtechniques": true, "comment": "[UNC2452](https://attack.mitre.org/groups/G0118) added their own devices as allowed IDs for active sync using Set-CASMailbox, allowing it to obtain copies of victim mailboxes. It also added additional permissions (such as Mail.Read and Mail.ReadWrite) to compromised Application or Service Principals.(Citation: Volexity SolarWinds)(Citation: Microsoft - Customer Guidance on Recent Nation-State Cyber Attacks)"}, {"score": 1, "techniqueID": "T1098.001", "showSubtechniques": true, "comment": "[UNC2452](https://attack.mitre.org/groups/G0118) added credentials to OAuth Applications and Service Principals.(Citation: Microsoft - Customer Guidance on Recent Nation-State Cyber Attacks) "}, {"techniqueID": "T1071", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1071.001", "showSubtechniques": true, "comment": "[UNC2452](https://attack.mitre.org/groups/G0118) used HTTP for C2 and data exfiltration.(Citation: Volexity SolarWinds)"}, {"techniqueID": "T1560", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1560.001", "showSubtechniques": true, "comment": "[UNC2452](https://attack.mitre.org/groups/G0118) used 7-Zip to compress stolen emails into password-protected archives prior to exfiltration.(Citation: Volexity SolarWinds)(Citation: Microsoft Deep Dive Solorigate January 2021)"}, {"techniqueID": "T1059", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1059.001", "showSubtechniques": true, "comment": "[UNC2452](https://attack.mitre.org/groups/G0118) used PowerShell to create new tasks on remote machines, identify configuration settings, exfiltrate data, and to execute other commands.(Citation: Volexity SolarWinds)(Citation: Microsoft Analyzing Solorigate Dec 2020)"}, {"score": 1, "techniqueID": "T1059.003", "showSubtechniques": true, "comment": "[UNC2452](https://attack.mitre.org/groups/G0118) used cmd.exe to execute commands on remote machines.(Citation: Volexity SolarWinds)(Citation: Microsoft Analyzing Solorigate Dec 2020)"}, {"score": 1, "techniqueID": "T1555", "showSubtechniques": false, "comment": "[UNC2452](https://attack.mitre.org/groups/G0118) used account credentials they obtained to attempt access to Group Managed Service Account (gMSA) passwords.(Citation: Microsoft Deep Dive Solorigate January 2021)"}, {"score": 1, "techniqueID": "T1005", "showSubtechniques": false, "comment": "[UNC2452](https://attack.mitre.org/groups/G0118) extracted files from compromised networks.(Citation: Volexity SolarWinds) "}, {"techniqueID": "T1074", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1074.002", "showSubtechniques": true, "comment": "[UNC2452](https://attack.mitre.org/groups/G0118) staged data and files in password-protected archives on a victim's OWA server.(Citation: Volexity SolarWinds)"}, {"score": 1, "techniqueID": "T1140", "showSubtechniques": false, "comment": "[UNC2452](https://attack.mitre.org/groups/G0118) used 7-Zip to decode its [Raindrop](https://attack.mitre.org/software/S0565) malware.(Citation: Symantec RAINDROP January 2021)"}, {"techniqueID": "T1587", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1587.001", "showSubtechniques": true, "comment": "[UNC2452](https://attack.mitre.org/groups/G0118) developed [Sunspot](https://attack.mitre.org/software/S0562), [Sunburst](https://attack.mitre.org/software/S0559), [Teardrop](https://attack.mitre.org/software/S0560), and [Raindrop](https://attack.mitre.org/software/S0565); [Sunspot](https://attack.mitre.org/software/S0562) and [Sunburst](https://attack.mitre.org/software/S0559) were tailored to be incorporated into SolarWind's Orion software library.(Citation: FireEye SUNBURST Backdoor December 2020)(Citation: CrowdStrike SUNSPOT Implant January 2021)(Citation: Microsoft Deep Dive Solorigate January 2021)"}, {"techniqueID": "T1484", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1484.002", "showSubtechniques": true, "comment": "[UNC2452](https://attack.mitre.org/groups/G0118) changed domain federation trust settings using Azure AD administrative permissions to configure the domain to accept authorization tokens signed by their own SAML signing certificate.(Citation: Microsoft 365 Defender Solorigate)"}, {"score": 1, "techniqueID": "T1482", "showSubtechniques": false, "comment": "[UNC2452](https://attack.mitre.org/groups/G0118) used the Get-AcceptedDomain PowerShell cmdlet to enumerate accepted domains through an Exchange Management Shell.(Citation: Volexity SolarWinds) They also used [AdFind](https://attack.mitre.org/software/S0552) to enumerate domains and to discover trust between federated domains.(Citation: Microsoft Deep Dive Solorigate January 2021)"}, {"score": 1, "techniqueID": "T1568", "showSubtechniques": false, "comment": "[UNC2452](https://attack.mitre.org/groups/G0118) used dynamic DNS resolution to construct and resolve to randomly-generated subdomains for C2.(Citation: Volexity SolarWinds)"}, {"techniqueID": "T1114", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1114.002", "showSubtechniques": true, "comment": "[UNC2452](https://attack.mitre.org/groups/G0118) collected emails from specific individuals, such as executives and IT staff, using New-MailboxExportRequest followed by Get-MailboxExportRequest.(Citation: Volexity SolarWinds)"}, {"techniqueID": "T1546", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1546.003", "showSubtechniques": true, "comment": "[UNC2452](https://attack.mitre.org/groups/G0118) used WMI event subscriptions for persistence.(Citation: Microsoft 365 Defender Solorigate)(Citation: Microsoft Deep Dive Solorigate January 2021)"}, {"techniqueID": "T1048", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1048.002", "showSubtechniques": true, "comment": "[UNC2452](https://attack.mitre.org/groups/G0118) exfiltrated collected data over a simple HTTPS request to a password-protected archive staged on a victim's OWA servers.(Citation: Volexity SolarWinds)"}, {"score": 1, "techniqueID": "T1190", "showSubtechniques": false, "comment": "[UNC2452](https://attack.mitre.org/groups/G0118) exploited CVE-2020-0688 against the Microsoft Exchange Control Panel to regain access to a network.(Citation: Volexity SolarWinds)"}, {"score": 1, "techniqueID": "T1083", "showSubtechniques": false, "comment": "[UNC2452](https://attack.mitre.org/groups/G0118) obtained information about the configured Exchange virtual directory using Get-WebServicesVirtualDirectory.(Citation: Volexity SolarWinds)"}, {"techniqueID": "T1606", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1606.001", "showSubtechniques": true, "comment": "[UNC2452](https://attack.mitre.org/groups/G0118) bypassed MFA set on OWA accounts by generating a cookie value from a previously stolen secret key.(Citation: Volexity SolarWinds)"}, {"score": 1, "techniqueID": "T1606.002", "showSubtechniques": true, "comment": "[UNC2452](https://attack.mitre.org/groups/G0118) created tokens using compromised SAML signing certificates.(Citation: Microsoft - Customer Guidance on Recent Nation-State Cyber Attacks)"}, {"techniqueID": "T1562", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1562.004", "showSubtechniques": true, "comment": "[UNC2452](https://attack.mitre.org/groups/G0118) used netsh to configure firewall rules that limited certain UDP outbound packets.(Citation: Microsoft Deep Dive Solorigate January 2021)"}, {"score": 1, "techniqueID": "T1562.002", "showSubtechniques": true, "comment": "[UNC2452](https://attack.mitre.org/groups/G0118) used AUDITPOL to prevent the collection of audit logs.(Citation: Microsoft Deep Dive Solorigate January 2021)"}, {"score": 1, "techniqueID": "T1562.001", "showSubtechniques": true, "comment": "[UNC2452](https://attack.mitre.org/groups/G0118) used the service control manager on a remote system to disable services associated with security monitoring products.(Citation: Microsoft Deep Dive Solorigate January 2021)"}, {"score": 1, "techniqueID": "T1070", "showSubtechniques": true, "comment": "[UNC2452](https://attack.mitre.org/groups/G0118) removed evidence of email export requests using Remove-MailboxExportRequest.(Citation: Volexity SolarWinds) They temporarily replaced legitimate utilities with their own, executed their payload, and then restored the original file.(Citation: FireEye SUNBURST Backdoor December 2020)"}, {"score": 1, "techniqueID": "T1070.004", "showSubtechniques": true, "comment": "[UNC2452](https://attack.mitre.org/groups/G0118) routinely removed their tools, including custom backdoors, once remote access was achieved.(Citation: FireEye SUNBURST Backdoor December 2020)"}, {"score": 1, "techniqueID": "T1070.006", "showSubtechniques": true, "comment": "[UNC2452](https://attack.mitre.org/groups/G0118) modified timestamps of backdoors to match legitimate Windows files.(Citation: Microsoft Deep Dive Solorigate January 2021)"}, {"score": 1, "techniqueID": "T1105", "showSubtechniques": false, "comment": "[UNC2452](https://attack.mitre.org/groups/G0118) downloaded additional tools, such as [Teardrop](https://attack.mitre.org/software/S0560) malware and [Cobalt Strike](https://attack.mitre.org/software/S0154), to the compromised host following initial compromise.(Citation: FireEye SUNBURST Backdoor December 2020)"}, {"score": 1, "techniqueID": "T1036", "showSubtechniques": true, "comment": "[UNC2452](https://attack.mitre.org/groups/G0118) set the hostnames of its C2 infrastructure to match legitimate hostnames in the victim environment. They also primarily used IP addresses originating from the same country as the victim for their VPN infrastructure.(Citation: FireEye SUNBURST Backdoor December 2020)"}, {"score": 1, "techniqueID": "T1036.004", "showSubtechniques": true, "comment": "[UNC2452](https://attack.mitre.org/groups/G0118) named tasks \\Microsoft\\Windows\\SoftwareProtectionPlatform\\EventCacheManager in order to appear legitimate.(Citation: Volexity SolarWinds)"}, {"score": 1, "techniqueID": "T1036.005", "showSubtechniques": true, "comment": "[UNC2452](https://attack.mitre.org/groups/G0118) renamed a version of [AdFind](https://attack.mitre.org/software/S0552) to sqlceip.exe or csrss.exe in an attempt to appear as the SQL Server Telemetry Client or Client Service Runtime Process, respectively.(Citation: Volexity SolarWinds)(Citation: Microsoft Analyzing Solorigate Dec 2020)"}, {"score": 1, "techniqueID": "T1027", "showSubtechniques": false, "comment": "[UNC2452](https://attack.mitre.org/groups/G0118) used encoded PowerShell commands.(Citation: Microsoft - Customer Guidance on Recent Nation-State Cyber Attacks)"}, {"techniqueID": "T1003", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1003.006", "showSubtechniques": true, "comment": "[UNC2452](https://attack.mitre.org/groups/G0118) leveraged privileged accounts to replicate directory service data with domain controllers.(Citation: Microsoft 365 Defender Solorigate)(Citation: Microsoft Deep Dive Solorigate January 2021)"}, {"score": 1, "techniqueID": "T1069", "showSubtechniques": false, "comment": "[UNC2452](https://attack.mitre.org/groups/G0118) used the Get-ManagementRoleAssignment PowerShell cmdlet to enumerate Exchange management role assignments through an Exchange Management Shell.(Citation: Volexity SolarWinds)"}, {"score": 1, "techniqueID": "T1057", "showSubtechniques": false, "comment": "[UNC2452](https://attack.mitre.org/groups/G0118) used multiple command-line utilities to enumerate running processes.(Citation: Volexity SolarWinds)(Citation: Microsoft Deep Dive Solorigate January 2021)"}, {"techniqueID": "T1090", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1090.001", "showSubtechniques": true, "comment": "[UNC2452](https://attack.mitre.org/groups/G0118) configured at least one instance of [Cobalt Strike](https://attack.mitre.org/software/S0154) to use a network pipe over SMB during the 2020 SolarWinds intrusion.(Citation: Symantec RAINDROP January 2021)"}, {"techniqueID": "T1021", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1021.006", "showSubtechniques": true, "comment": "[UNC2452](https://attack.mitre.org/groups/G0118) has used WinRM via PowerShell to execute command and payloads on remote hosts.(Citation: Symantec RAINDROP January 2021)"}, {"score": 1, "techniqueID": "T1018", "showSubtechniques": false, "comment": "[UNC2452](https://attack.mitre.org/groups/G0118) used [AdFind](https://attack.mitre.org/software/S0552) to enumerate remote systems.(Citation: Microsoft Deep Dive Solorigate January 2021)"}, {"techniqueID": "T1053", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1053.005", "showSubtechniques": true, "comment": "[UNC2452](https://attack.mitre.org/groups/G0118) used scheduler and schtasks to create new tasks on remote hosts as part of lateral movement.(Citation: Volexity SolarWinds) They also manipulated scheduled tasks by updating an existing legitimate task to execute their tools and then returned the scheduled task to its original configuration.(Citation: FireEye SUNBURST Backdoor December 2020) [UNC2452](https://attack.mitre.org/groups/G0118) also created a scheduled task to maintain [Sunspot](https://attack.mitre.org/software/S0562) persistence when the host booted.(Citation: CrowdStrike SUNSPOT Implant January 2021) "}, {"techniqueID": "T1218", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1218.011", "showSubtechniques": true, "comment": "[UNC2452](https://attack.mitre.org/groups/G0118) used Rundll32 to execute payloads.(Citation: Microsoft - Customer Guidance on Recent Nation-State Cyber Attacks)(Citation: Microsoft Deep Dive Solorigate January 2021)"}, {"techniqueID": "T1558", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1558.003", "showSubtechniques": true, "comment": "[UNC2452](https://attack.mitre.org/groups/G0118) obtained Ticket Granting Service (TGS) tickets for Active Directory Service Principle Names to crack offline.(Citation: Microsoft Deep Dive Solorigate January 2021)"}, {"techniqueID": "T1553", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1553.002", "showSubtechniques": true, "comment": "[UNC2452](https://attack.mitre.org/groups/G0118) was able to get [Sunburst](https://attack.mitre.org/software/S0559) signed by SolarWinds code signing certificates by injecting the malware into the SolarWinds Orion software lifecycle.(Citation: FireEye SUNBURST Backdoor December 2020)"}, {"techniqueID": "T1195", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1195.002", "showSubtechniques": true, "comment": "[UNC2452](https://attack.mitre.org/groups/G0118) gained initial network access via a trojanized update of SolarWinds Orion software.(Citation: FireEye SUNBURST Backdoor December 2020)"}, {"score": 1, "techniqueID": "T1082", "showSubtechniques": false, "comment": "[UNC2452](https://attack.mitre.org/groups/G0118) used fsutil to check available free space before executing actions that might create large files on disk.(Citation: Microsoft Deep Dive Solorigate January 2021)"}, {"techniqueID": "T1552", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1552.004", "showSubtechniques": true, "comment": "[UNC2452](https://attack.mitre.org/groups/G0118) obtained the private encryption key from an Active Directory Federation Services (AD FS) container to decrypt corresponding SAML signing certificates.(Citation: Microsoft 365 Defender Solorigate)"}, {"score": 1, "techniqueID": "T1550", "showSubtechniques": true, "comment": "[UNC2452](https://attack.mitre.org/groups/G0118) used forged SAML tokens that allowed the actors to impersonate users and bypass MFA, enabling [UNC2452](https://attack.mitre.org/groups/G0118) to access enterprise cloud applications and services.(Citation: Microsoft 365 Defender Solorigate)"}, {"score": 1, "techniqueID": "T1550.004", "showSubtechniques": true, "comment": "[UNC2452](https://attack.mitre.org/groups/G0118) used a forged duo-sid cookie to bypass MFA set on an email account.(Citation: Volexity SolarWinds)"}, {"score": 1, "techniqueID": "T1078", "showSubtechniques": false, "comment": "[UNC2452](https://attack.mitre.org/groups/G0118) used different compromised credentials for remote access and to move laterally.(Citation: FireEye SUNBURST Backdoor December 2020)"}, {"score": 1, "techniqueID": "T1047", "showSubtechniques": false, "comment": "[UNC2452](https://attack.mitre.org/groups/G0118) used WMI for the remote execution of files for lateral movement.(Citation: Microsoft 365 Defender Solorigate)(Citation: Microsoft Deep Dive Solorigate January 2021)"}], "gradient": {"colors": ["#ffffff", "#66b1ff"], "minValue": 0, "maxValue": 1}, "legendItems": [{"label": "used by UNC2452", "color": "#66b1ff"}]}