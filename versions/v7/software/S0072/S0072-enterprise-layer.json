{"description": "Enterprise techniques used by OwaAuth, ATT&CK software S0072 v1.1", "name": "OwaAuth (S0072)", "domain": "mitre-enterprise", "version": "3.0", "techniques": [{"techniqueID": "T1071", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1071.001", "showSubtechniques": true, "comment": "OwaAuth uses incoming HTTP requests with a username keyword and commands and handles them as instructions to perform actions.[1]"}, {"techniqueID": "T1560", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1560.003", "showSubtechniques": true, "comment": "OwaAuth DES-encrypts captured credentials using the key 12345678 before writing the credentials to a log file.[1]"}, {"score": 1, "techniqueID": "T1083", "showSubtechniques": false, "comment": "OwaAuth has a command to list its directory and logical drives.[1]"}, {"techniqueID": "T1574", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1574.002", "showSubtechniques": true, "comment": "OwaAuth has been loaded onto Exchange servers and disguised as an ISAPI filter (DLL file). The IIS w3wp.exe process then loads the malicious DLL.[1]"}, {"techniqueID": "T1070", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1070.006", "showSubtechniques": true, "comment": "OwaAuth has a command to timestop a file or directory.[1]"}, {"techniqueID": "T1056", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1056.001", "showSubtechniques": true, "comment": "OwaAuth captures and DES-encrypts credentials before writing the username and password to a log file, C:\\log.txt.[1]"}, {"techniqueID": "T1036", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1036.005", "showSubtechniques": true, "comment": "OwaAuth uses the filename owaauth.dll, which is a legitimate file that normally resides in %ProgramFiles%\\Microsoft\\Exchange Server\\ClientAccess\\Owa\\Auth\\; the malicious file by the same name is saved in %ProgramFiles%\\Microsoft\\Exchange Server\\ClientAccess\\Owa\\bin\\.[1]"}, {"techniqueID": "T1505", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1505.003", "showSubtechniques": true, "comment": "OwaAuth is a Web shell that appears to be exclusively used by Threat Group-3390. It is installed as an ISAPI filter on Exchange servers and shares characteristics with the China Chopper Web shell.[1]"}], "gradient": {"colors": ["#ffffff", "#66b1ff"], "minValue": 0, "maxValue": 1}, "legendItems": [{"label": "used by OwaAuth", "color": "#66b1ff"}]}