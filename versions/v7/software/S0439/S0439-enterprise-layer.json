{"description": "Enterprise techniques used by Okrum, ATT&CK software S0439 v1.0", "name": "Okrum (S0439)", "domain": "mitre-enterprise", "version": "3.0", "techniques": [{"techniqueID": "T1134", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1134.001", "showSubtechniques": true, "comment": "Okrum can impersonate a logged-on user's security context using a call to the ImpersonateLoggedOnUser API.[1]"}, {"techniqueID": "T1071", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1071.001", "showSubtechniques": true, "comment": "Okrum uses HTTP for communication with its C2.[1]"}, {"techniqueID": "T1560", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1560.003", "showSubtechniques": true, "comment": "Okrum has used a custom implementation of AES encryption to encrypt collected data.[1]"}, {"score": 1, "techniqueID": "T1560.001", "showSubtechniques": true, "comment": "Okrum was seen using a RAR archiver tool to compress/decompress data.[1]"}, {"techniqueID": "T1547", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1547.009", "showSubtechniques": true, "comment": "Okrum can establish persistence by creating a .lnk shortcut to itself in the Startup folder.[1]"}, {"score": 1, "techniqueID": "T1547.001", "showSubtechniques": true, "comment": "Okrum establishes persistence by creating a .lnk shortcut to itself in the Startup folder.[1] "}, {"techniqueID": "T1059", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1059.003", "showSubtechniques": true, "comment": "Okrum's backdoor has used cmd.exe to execute arbitrary commands as well as batch scripts to update itself to a newer version.[1]"}, {"techniqueID": "T1543", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1543.003", "showSubtechniques": true, "comment": "To establish persistence, Okrum can install itself as a new service named NtmSsvc.[1]"}, {"techniqueID": "T1132", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1132.001", "showSubtechniques": true, "comment": "Okrum has used base64 to encode C2 communication.[1]"}, {"techniqueID": "T1001", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1001.003", "showSubtechniques": true, "comment": "Okrum mimics HTTP protocol for C2 communication, while hiding the actual messages in the Cookie and Set-Cookie headers of the HTTP requests.[1]"}, {"score": 1, "techniqueID": "T1140", "showSubtechniques": false, "comment": "Okrum's loader can decrypt the backdoor code, embedded within the loader or within a legitimate PNG file. A custom XOR cipher or RC4 is used for decryption.[1]"}, {"techniqueID": "T1573", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1573.001", "showSubtechniques": true, "comment": "Okrum uses AES to encrypt network traffic. The key can be hardcoded or negotiated with the C2 server in the registration phase. [1]"}, {"score": 1, "techniqueID": "T1041", "showSubtechniques": false, "comment": "Data exfiltration is done by Okrum using the already opened channel with the C2 server.[1]"}, {"score": 1, "techniqueID": "T1083", "showSubtechniques": false, "comment": "Okrum has used DriveLetterView to enumerate drive information.[1]"}, {"techniqueID": "T1564", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1564.001", "showSubtechniques": true, "comment": "Before exfiltration, Okrum's backdoor has used hidden files to store logs and outputs from backdoor commands.[1]"}, {"techniqueID": "T1070", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1070.004", "showSubtechniques": true, "comment": "Okrum's backdoor deletes files after they have been successfully uploaded to C2 servers.[1]"}, {"score": 1, "techniqueID": "T1105", "showSubtechniques": false, "comment": "Okrum has built-in commands for uploading, downloading, and executing files to the system.[1]"}, {"techniqueID": "T1056", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1056.001", "showSubtechniques": true, "comment": "Okrum was seen using a keylogger tool to capture keystrokes. [1]"}, {"techniqueID": "T1036", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1036.004", "showSubtechniques": true, "comment": "Okrum can establish persistence by adding a new service NtmsSvc with the display name Removable Storage to masquerade as a legitimate Removable Storage Manager.[1]"}, {"techniqueID": "T1027", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1027.003", "showSubtechniques": true, "comment": "Okrum's payload is encrypted and embedded within its loader, or within a legitimate PNG file.[1]"}, {"techniqueID": "T1003", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1003.005", "showSubtechniques": true, "comment": "Okrum was seen using modified Quarks PwDump to perform credential dumping.[1]"}, {"score": 1, "techniqueID": "T1003.001", "showSubtechniques": true, "comment": "Okrum was seen using MimikatzLite to perform credential dumping.[1]"}, {"techniqueID": "T1090", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1090.002", "showSubtechniques": true, "comment": "Okrum can identify proxy servers configured and used by the victim, and use it to make HTTP requests to C2 its server.[1]"}, {"techniqueID": "T1053", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1053.005", "showSubtechniques": true, "comment": "Okrum's installer can attempt to achieve persistence by creating a scheduled task.[1]"}, {"score": 1, "techniqueID": "T1082", "showSubtechniques": false, "comment": "Okrum can collect computer name, locale information, and information about the OS and architecture.[1]"}, {"score": 1, "techniqueID": "T1016", "showSubtechniques": false, "comment": "Okrum can collect network information, including the host IP address, DNS, and proxy information.[1]"}, {"score": 1, "techniqueID": "T1049", "showSubtechniques": false, "comment": "Okrum was seen using NetSess to discover NetBIOS sessions.[1]"}, {"score": 1, "techniqueID": "T1033", "showSubtechniques": false, "comment": "Okrum can collect the victim username.[1]"}, {"techniqueID": "T1569", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1569.002", "showSubtechniques": true, "comment": "Okrum's loader can create a new service named NtmsSvc to execute the payload.[1]"}, {"score": 1, "techniqueID": "T1124", "showSubtechniques": false, "comment": "Okrum can obtain the date and time of the compromised system.[1]"}, {"techniqueID": "T1497", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1497.003", "showSubtechniques": true, "comment": "Okrum's loader can detect presence of an emulator by using two calls to GetTickCount API, and checking whether the time has been accelerated.[1]"}, {"score": 1, "techniqueID": "T1497.001", "showSubtechniques": true, "comment": "Okrum's loader can check the amount of physical memory and terminates itself if the host has less than 1.5 Gigabytes of physical memory in total.[1]"}, {"score": 1, "techniqueID": "T1497.002", "showSubtechniques": true, "comment": "Okrum loader only executes the payload after the left mouse button has been pressed at least three times, in order to avoid being executed within virtualized or emulated environments.[1] "}], "gradient": {"colors": ["#ffffff", "#66b1ff"], "minValue": 0, "maxValue": 1}, "legendItems": [{"label": "used by Okrum", "color": "#66b1ff"}]}