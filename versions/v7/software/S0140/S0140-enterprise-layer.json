{"description": "Enterprise techniques used by Shamoon, ATT&CK software S0140 v2.1", "name": "Shamoon (S0140)", "domain": "mitre-enterprise", "version": "3.0", "techniques": [{"techniqueID": "T1548", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1548.002", "showSubtechniques": true, "comment": "Shamoon attempts to disable UAC remote restrictions by modifying the Registry.[1]"}, {"techniqueID": "T1134", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1134.001", "showSubtechniques": true, "comment": "Shamoon can impersonate tokens using LogonUser, ImpersonateLoggedOnUser, and ImpersonateNamedPipeClient.[5]"}, {"techniqueID": "T1071", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1071.001", "showSubtechniques": true, "comment": "Shamoon has used HTTP for C2.[1]"}, {"techniqueID": "T1543", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1543.003", "showSubtechniques": true, "comment": "Shamoon creates a new service named \"ntssrv\" to execute the payload. Newer versions create the \"MaintenaceSrv\" and \"hdv_725x\" services.[1][2]"}, {"score": 1, "techniqueID": "T1485", "showSubtechniques": false, "comment": "Shamoon attempts to overwrite operating system files and disk structures with image files.[3][4][1] In a later variant, randomly generated data was used for data overwrites.[2][5]"}, {"score": 1, "techniqueID": "T1486", "showSubtechniques": false, "comment": "Shamoon has an operational mode for encrypting data instead of overwriting it.[1][2]"}, {"score": 1, "techniqueID": "T1140", "showSubtechniques": false, "comment": "Shamoon decrypts ciphertext using an XOR cipher and a base64-encoded string.[2]   "}, {"techniqueID": "T1561", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1561.002", "showSubtechniques": true, "comment": "Shamoon has been seen overwriting features of disk structure such as the MBR.[3][4][1][2]"}, {"techniqueID": "T1070", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1070.006", "showSubtechniques": true, "comment": "Shamoon can change the modified time for files to evade forensic detection.[5] "}, {"score": 1, "techniqueID": "T1105", "showSubtechniques": false, "comment": "Shamoon can download an executable to run on the victim.[1]"}, {"score": 1, "techniqueID": "T1570", "showSubtechniques": false, "comment": "Shamoon attempts to copy itself to remote machines on the network.[1]"}, {"techniqueID": "T1036", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1036.004", "showSubtechniques": true, "comment": "Shamoon creates a new service named \"ntssrv\" that attempts to appear legitimate; the service's display name is \"Microsoft Network Realtime Inspection Service\" and its description is \"Helps guard against time change attempts targeting known and newly discovered vulnerabilities in network time protocols.\" Newer versions create the \"MaintenaceSrv\" service, which misspells the word \"maintenance.\"[1][5]"}, {"score": 1, "techniqueID": "T1112", "showSubtechniques": false, "comment": "Once Shamoon has access to a network share, it enables the RemoteRegistry service on the target system. It will then connect to the system with RegConnectRegistryW and modify the Registry to disable UAC remote restrictions by setting SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\LocalAccountTokenFilterPolicy to 1.[4][1][5]"}, {"score": 1, "techniqueID": "T1027", "showSubtechniques": false, "comment": "Shamoon contains base64-encoded strings.[1]"}, {"score": 1, "techniqueID": "T1012", "showSubtechniques": false, "comment": "Shamoon queries several Registry keys to identify hard disk partitions to overwrite.[1]"}, {"techniqueID": "T1021", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1021.002", "showSubtechniques": true, "comment": "Shamoon accesses network share(s), enables share access to the target device, copies an executable payload to the target system, and uses a Scheduled Task/Job to execute the malware.[4]"}, {"score": 1, "techniqueID": "T1018", "showSubtechniques": false, "comment": "Shamoon scans the C-class subnet of the IPs on the victim's interfaces.[4]"}, {"techniqueID": "T1053", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1053.005", "showSubtechniques": true, "comment": "Shamoon copies an executable payload to the target system by using Windows Admin Shares and then scheduling an unnamed task to execute the malware.[4][1]"}, {"score": 1, "techniqueID": "T1082", "showSubtechniques": false, "comment": "Shamoon obtains the victim's operating system version and keyboard layout and sends the information to the C2 server.[1][2]"}, {"score": 1, "techniqueID": "T1016", "showSubtechniques": false, "comment": "Shamoon obtains the target's IP address and local network segment.[1][5]"}, {"techniqueID": "T1569", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1569.002", "showSubtechniques": true, "comment": "Shamoon creates a new service named \"ntssrv\" to execute the payload. Shamoon can also spread via PsExec.[1][6]"}, {"score": 1, "techniqueID": "T1529", "showSubtechniques": false, "comment": "Shamoon will reboot the infected system once the wiping functionality has been completed.[2][5] "}, {"score": 1, "techniqueID": "T1124", "showSubtechniques": false, "comment": "Shamoon obtains the system time and will only activate if it is greater than a preset date.[1][2]"}, {"techniqueID": "T1078", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1078.002", "showSubtechniques": true, "comment": "If Shamoon cannot access shares using current privileges, it attempts access using hard coded, domain-specific credentials gathered earlier in the intrusion.[4][2]"}], "gradient": {"colors": ["#ffffff", "#66b1ff"], "minValue": 0, "maxValue": 1}, "legendItems": [{"label": "used by Shamoon", "color": "#66b1ff"}]}