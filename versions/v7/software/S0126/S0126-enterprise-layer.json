{"description": "Enterprise techniques used by ComRAT, ATT&CK software S0126 v1.1", "name": "ComRAT (S0126)", "domain": "mitre-enterprise", "version": "3.0", "techniques": [{"techniqueID": "T1071", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1071.001", "showSubtechniques": true, "comment": "ComRAT has used HTTP requests for command and control.[2][3]"}, {"score": 1, "techniqueID": "T1071.003", "showSubtechniques": true, "comment": "ComRAT can use email attachments for command and control.[3]"}, {"techniqueID": "T1059", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1059.003", "showSubtechniques": true, "comment": "ComRAT has used cmd.exe to execute commands.[3]"}, {"score": 1, "techniqueID": "T1059.001", "showSubtechniques": true, "comment": "ComRAT has used PowerShell to load itself every time a user logs in to the system. ComRAT can execute PowerShell scripts loaded into memory or from the file system.[3]"}, {"score": 1, "techniqueID": "T1140", "showSubtechniques": false, "comment": "ComRAT has used unique per machine passwords to decrypt the orchestrator payload and a hardcoded XOR key to decrypt its communications module. ComRAT has also used a unique password to decrypt the file used for its hidden file system.[3]"}, {"techniqueID": "T1573", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1573.002", "showSubtechniques": true, "comment": "ComRAT can use SSL/TLS encryption for its HTTP-based C2 channel. ComRAT has used public key cryptography with RSA and AES encrypted email attachments for its Gmail C2 channel.[3]"}, {"techniqueID": "T1546", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1546.015", "showSubtechniques": true, "comment": "ComRAT samples have been seen which hijack COM objects for persistence by replacing the path to shell32.dll in registry location HKCU\\Software\\Classes\\CLSID{{42aedc87-2188-41fd-b9a3-0c966feabec1}}\\InprocServer32.[2]"}, {"techniqueID": "T1564", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1564.005", "showSubtechniques": true, "comment": "ComRAT has used a portable FAT16 partition image placed in %TEMP% as a hidden file system.[3]"}, {"techniqueID": "T1036", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1036.004", "showSubtechniques": true, "comment": "ComRAT has used a task name associated with Windows SQM Consolidator.[3]"}, {"score": 1, "techniqueID": "T1112", "showSubtechniques": false, "comment": "ComRAT has encrypted and stored its orchestrator code in the Registry.[3]"}, {"score": 1, "techniqueID": "T1106", "showSubtechniques": false, "comment": "ComRAT can load a PE file from memory or the file system and execute it with CreateProcessW.[3]"}, {"score": 1, "techniqueID": "T1027", "showSubtechniques": false, "comment": "ComRAT has used encryption and base64 to obfuscate its orchestrator code in the Registry. ComRAT has also embedded an XOR encrypted communications module inside the orchestrator module. ComRAT has encrypted its virtual file system using AES-256 in XTS mode.[3]"}, {"techniqueID": "T1055", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1055.001", "showSubtechniques": true, "comment": "ComRAT has injected its orchestrator DLL into explorer.exe. ComRAT has also injected its communications module into the victim's default browser to make C2 connections appear less suspicious as all network connections will be initiated by the browser process.[3]"}, {"score": 1, "techniqueID": "T1012", "showSubtechniques": false, "comment": "ComRAT can check the default browser by querying HKCR\\http\\shell\\open\\command.[3]"}, {"techniqueID": "T1053", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1053.005", "showSubtechniques": true, "comment": "ComRAT has used a scheduled task to launch its PowerShell loader.[3]"}, {"score": 1, "techniqueID": "T1029", "showSubtechniques": false, "comment": "ComRAT has been programmed to sleep outside local business hours (9 to 5, Monday to Friday).[3]"}, {"score": 1, "techniqueID": "T1518", "showSubtechniques": false, "comment": "ComRAT can check the victim's default browser to determine which process to inject its communications module into.[3]"}, {"techniqueID": "T1102", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1102.002", "showSubtechniques": true, "comment": "ComRAT has the ability to use the Gmail web UI to receive commands and exfiltrate information.[3]"}], "gradient": {"colors": ["#ffffff", "#66b1ff"], "minValue": 0, "maxValue": 1}, "legendItems": [{"label": "used by ComRAT", "color": "#66b1ff"}]}