{"description": "Enterprise techniques used by Comnie, ATT&CK software S0244 v1.1", "name": "Comnie (S0244)", "domain": "mitre-enterprise", "version": "3.0", "techniques": [{"techniqueID": "T1087", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1087.001", "showSubtechniques": true, "comment": "Comnie uses the net user command.[1]"}, {"techniqueID": "T1071", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1071.001", "showSubtechniques": true, "comment": "Comnie uses HTTP for C2 communication.[1]"}, {"score": 1, "techniqueID": "T1119", "showSubtechniques": false, "comment": "Comnie executes a batch script to store discovery information in %TEMP%\\info.dat and then uploads the temporarily file to the remote C2 server.[1]"}, {"techniqueID": "T1547", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1547.001", "showSubtechniques": true, "comment": "Comnie achieves persistence by adding a shortcut of itself to the startup path in the Registry.[1]"}, {"score": 1, "techniqueID": "T1547.009", "showSubtechniques": true, "comment": "Comnie establishes persistence via a .lnk file in the victim\u2019s startup path.[1]"}, {"techniqueID": "T1059", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1059.003", "showSubtechniques": true, "comment": "Comnie executes BAT scripts.[1]"}, {"score": 1, "techniqueID": "T1059.005", "showSubtechniques": true, "comment": "Comnie executes VBS scripts.[1]"}, {"techniqueID": "T1573", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1573.001", "showSubtechniques": true, "comment": "Comnie encrypts command and control communications with RC4.[1]"}, {"score": 1, "techniqueID": "T1027", "showSubtechniques": true, "comment": "Comnie uses RC4 and Base64 to obfuscate strings.[1]"}, {"score": 1, "techniqueID": "T1027.001", "showSubtechniques": true, "comment": "Comnie appends a total of 64MB of garbage data to a file to deter any security products in place that may be scanning files on disk.[1]"}, {"score": 1, "techniqueID": "T1057", "showSubtechniques": false, "comment": "Comnie uses the tasklist to view running processes on the victim\u2019s machine.[1]"}, {"score": 1, "techniqueID": "T1018", "showSubtechniques": false, "comment": "Comnie runs the net view command"}, {"techniqueID": "T1218", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1218.011", "showSubtechniques": true, "comment": "Comnie uses Rundll32 to load a malicious DLL.[1]"}, {"techniqueID": "T1518", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1518.001", "showSubtechniques": true, "comment": "Comnie attempts to detect several anti-virus products.[1]"}, {"score": 1, "techniqueID": "T1082", "showSubtechniques": false, "comment": "Comnie collects the hostname of the victim machine.[1]"}, {"score": 1, "techniqueID": "T1016", "showSubtechniques": false, "comment": "Comnie uses ipconfig /all and route PRINT to identify network adapter and interface information.[1]"}, {"score": 1, "techniqueID": "T1049", "showSubtechniques": false, "comment": "Comnie executes the netstat -ano command.[1]"}, {"score": 1, "techniqueID": "T1007", "showSubtechniques": false, "comment": "Comnie runs the command: net start &gt;&gt; %TEMP%\\info.dat on a victim.[1]"}, {"techniqueID": "T1102", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1102.002", "showSubtechniques": true, "comment": "Comnie uses blogs and third-party sites (GitHub, tumbler, and BlogSpot) to avoid DNS-based blocking of their communication to the command and control server.[1]"}], "gradient": {"colors": ["#ffffff", "#66b1ff"], "minValue": 0, "maxValue": 1}, "legendItems": [{"label": "used by Comnie", "color": "#66b1ff"}]}