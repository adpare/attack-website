{"description": "Enterprise techniques used by ShimRat, ATT&CK software S0444 v1.0", "name": "ShimRat (S0444)", "domain": "mitre-enterprise", "version": "3.0", "techniques": [{"techniqueID": "T1548", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1548.002", "showSubtechniques": true, "comment": "ShimRat has hijacked the cryptbase.dll within migwiz.exe to escalate privileges. This prevented the User Access Control window from appearing.[1]"}, {"techniqueID": "T1071", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1071.001", "showSubtechniques": true, "comment": "ShimRat communicated over HTTP and HTTPS with C2 servers.[1]"}, {"techniqueID": "T1547", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1547.001", "showSubtechniques": true, "comment": "ShimRat has installed a registry based start-up key HKCU\\Software\\microsoft\\windows\\CurrentVersion\\Run to maintain persistence should other methods fail.[1]"}, {"techniqueID": "T1059", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1059.003", "showSubtechniques": true, "comment": "ShimRat can be issued a command shell function from the C2.[1]"}, {"techniqueID": "T1543", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1543.003", "showSubtechniques": true, "comment": "ShimRat has installed a Windows service to maintain persistence on victim machines.[1]"}, {"score": 1, "techniqueID": "T1005", "showSubtechniques": false, "comment": "ShimRat has the capability to upload collected files to a C2.[1]  "}, {"score": 1, "techniqueID": "T1140", "showSubtechniques": false, "comment": "ShimRat has decompressed its core DLL using shellcode once an impersonated antivirus component was running on a system.[1]"}, {"techniqueID": "T1546", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1546.011", "showSubtechniques": true, "comment": "ShimRat has installed shim databases in the AppPatch folder.[1]"}, {"score": 1, "techniqueID": "T1008", "showSubtechniques": false, "comment": "ShimRat has used a secondary C2 location if the first was unavailable.[1] "}, {"score": 1, "techniqueID": "T1083", "showSubtechniques": false, "comment": "ShimRat can list directories.[1]"}, {"score": 1, "techniqueID": "T1574", "showSubtechniques": false, "comment": "ShimRat can hijack the cryptbase.dll within migwiz.exe to escalate privileges and bypass UAC controls.[1]"}, {"techniqueID": "T1070", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1070.004", "showSubtechniques": true, "comment": "ShimRat can uninstall itself from compromised hosts, as well create and modify directories, delete, move, copy, and rename files.[1]"}, {"score": 1, "techniqueID": "T1105", "showSubtechniques": false, "comment": "ShimRat can download additional files.[1]"}, {"techniqueID": "T1036", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1036.004", "showSubtechniques": true, "comment": "ShimRat can impersonate Windows services and antivirus products to avoid detection on compromised systems.[1]"}, {"score": 1, "techniqueID": "T1112", "showSubtechniques": false, "comment": "ShimRat has registered two registry keys for shim databases.[1]"}, {"score": 1, "techniqueID": "T1106", "showSubtechniques": false, "comment": "ShimRat has used Windows API functions to install the service and shim.[1]    "}, {"score": 1, "techniqueID": "T1135", "showSubtechniques": false, "comment": "ShimRat can enumerate connected drives for infected host machines.[1]"}, {"score": 1, "techniqueID": "T1027", "showSubtechniques": true, "comment": "ShimRat has been delivered as a package that includes compressed DLL and shellcode payloads within a .dat file.[1]"}, {"score": 1, "techniqueID": "T1027.002", "showSubtechniques": true, "comment": "ShimRat's loader has been packed with the compressed ShimRat core DLL and the legitimate DLL for it to hijack.[1]"}, {"techniqueID": "T1090", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1090.002", "showSubtechniques": true, "comment": "ShimRat can use pre-configured HTTP proxies.[1]"}, {"score": 1, "techniqueID": "T1029", "showSubtechniques": false, "comment": "ShimRat can sleep when instructed to do so by the C2.[1]  "}], "gradient": {"colors": ["#ffffff", "#66b1ff"], "minValue": 0, "maxValue": 1}, "legendItems": [{"label": "used by ShimRat", "color": "#66b1ff"}]}