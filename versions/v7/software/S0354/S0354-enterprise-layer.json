{"description": "Enterprise techniques used by Denis, ATT&CK software S0354 v1.1", "name": "Denis (S0354)", "domain": "mitre-enterprise", "version": "3.0", "techniques": [{"techniqueID": "T1071", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1071.004", "showSubtechniques": true, "comment": "Denis has used DNS tunneling for C2 communications.[1][3][2]"}, {"techniqueID": "T1560", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1560.002", "showSubtechniques": true, "comment": "Denis compressed collected data using zlib.[3]"}, {"techniqueID": "T1059", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1059.003", "showSubtechniques": true, "comment": "Denis can launch a remote shell to execute arbitrary commands on the victim\u2019s machine.[1][2]"}, {"score": 1, "techniqueID": "T1059.001", "showSubtechniques": true, "comment": "Denis has a version written in PowerShell.[2] "}, {"techniqueID": "T1132", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1132.001", "showSubtechniques": true, "comment": "Denis encodes the data sent to the server in Base64.[2]"}, {"score": 1, "techniqueID": "T1140", "showSubtechniques": false, "comment": "Denis will decrypt important strings used for C&amp;C communication.[2]"}, {"score": 1, "techniqueID": "T1083", "showSubtechniques": false, "comment": "Denis has several commands to search directories for files.[1][2]"}, {"score": 1, "techniqueID": "T1574", "showSubtechniques": true, "comment": "Denis replaces the nonexistent Windows DLL \"msfte.dll\" with its own malicious version, which is loaded by the SearchIndexer.exe and SearchProtocolHost.exe.[2]"}, {"score": 1, "techniqueID": "T1574.002", "showSubtechniques": true, "comment": "Denis exploits a security vulnerability to load a fake DLL and execute its code.[1]"}, {"techniqueID": "T1070", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1070.004", "showSubtechniques": true, "comment": "Denis has a command to delete files from the victim\u2019s machine.[1][2]"}, {"score": 1, "techniqueID": "T1105", "showSubtechniques": false, "comment": "Denis deploys additional backdoors and hacking tools to the system.[2]"}, {"score": 1, "techniqueID": "T1106", "showSubtechniques": false, "comment": "Denis used the IsDebuggerPresent, OutputDebugString, and SetLastError APIs to avoid debugging. Denis used GetProcAddress and LoadLibrary to dynamically resolve APIs. Denis also used the Wow64SetThreadContext API as part of a process hollowing process.[2]    "}, {"score": 1, "techniqueID": "T1027", "showSubtechniques": false, "comment": "Denis obfuscates its code and encrypts the API names. Denis also encodes its payload in Base64.[3][2]"}, {"techniqueID": "T1055", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1055.012", "showSubtechniques": true, "comment": "Denis performed process hollowing through the API calls CreateRemoteThread, ResumeThread, and Wow64SetThreadContext.[2]"}, {"score": 1, "techniqueID": "T1012", "showSubtechniques": false, "comment": "Denis queries the Registry for keys and values.[2]"}, {"score": 1, "techniqueID": "T1082", "showSubtechniques": false, "comment": "Denis collects OS information and the computer name from the victim\u2019s machine.[3][2]"}, {"score": 1, "techniqueID": "T1016", "showSubtechniques": false, "comment": "Denis uses ipconfig to gather the IP address from the system.[2]"}, {"score": 1, "techniqueID": "T1033", "showSubtechniques": false, "comment": "Denis enumerates and collects the username from the victim\u2019s machine.[3][2]"}, {"techniqueID": "T1497", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1497.001", "showSubtechniques": true, "comment": "Denis ran multiple system checks, looking for processor and register characteristics, to evade emulation and analysis.[2]"}], "gradient": {"colors": ["#ffffff", "#66b1ff"], "minValue": 0, "maxValue": 1}, "legendItems": [{"label": "used by Denis", "color": "#66b1ff"}]}