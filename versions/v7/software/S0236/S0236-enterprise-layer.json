{"description": "Enterprise techniques used by Kwampirs, ATT&CK software S0236 v1.1", "name": "Kwampirs (S0236)", "domain": "mitre-enterprise", "version": "3.0", "techniques": [{"techniqueID": "T1087", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1087.001", "showSubtechniques": true, "comment": "Kwampirs collects a list of accounts with the command net users.[1]"}, {"techniqueID": "T1543", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1543.003", "showSubtechniques": true, "comment": "Kwampirs creates a new service named WmiApSrvEx to establish persistence.[1]"}, {"score": 1, "techniqueID": "T1140", "showSubtechniques": false, "comment": "Kwampirs decrypts and extracts a copy of its main DLL payload when executing.[1]"}, {"score": 1, "techniqueID": "T1008", "showSubtechniques": false, "comment": "Kwampirs uses a large list of C2 servers that it cycles through until a successful connection is established.[1]"}, {"score": 1, "techniqueID": "T1083", "showSubtechniques": false, "comment": "Kwampirs collects a list of files and directories in C:\\ with the command dir /s /a c:\\ &gt;&gt; \"C:\\windows\\TEMP[RANDOM].tmp\".[1]"}, {"score": 1, "techniqueID": "T1105", "showSubtechniques": false, "comment": "Kwampirs downloads additional files from C2 servers.[2]"}, {"techniqueID": "T1036", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1036.004", "showSubtechniques": true, "comment": "Kwampirs establishes persistence by adding a new service with the display name \"WMI Performance Adapter Extension\" in an attempt to masquerade as a legitimate WMI service.[1]"}, {"score": 1, "techniqueID": "T1135", "showSubtechniques": false, "comment": "Kwampirs collects a list of network shares with the command net share.[1]"}, {"score": 1, "techniqueID": "T1027", "showSubtechniques": true, "comment": "Kwampirs downloads additional files that are base64-encoded and encrypted with another cipher.[2]"}, {"score": 1, "techniqueID": "T1027.001", "showSubtechniques": true, "comment": "Before writing to disk, Kwampirs inserts a randomly generated string into the middle of the decrypted payload in an attempt to evade hash-based detections.[1]"}, {"score": 1, "techniqueID": "T1201", "showSubtechniques": false, "comment": "Kwampirs collects password policy information with the command net accounts.[1]"}, {"techniqueID": "T1069", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1069.001", "showSubtechniques": true, "comment": "Kwampirs collects a list of users belonging to the local users and administrators groups with the commands net localgroup administrators and net localgroup users.[1]"}, {"score": 1, "techniqueID": "T1069.002", "showSubtechniques": true, "comment": "Kwampirs collects a list of domain groups with the command net localgroup /domain.[1]"}, {"score": 1, "techniqueID": "T1057", "showSubtechniques": false, "comment": "Kwampirs collects a list of running services with the command tasklist /v.[1]"}, {"techniqueID": "T1021", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1021.002", "showSubtechniques": true, "comment": "Kwampirs copies itself over network shares to move laterally on a victim network.[1]"}, {"score": 1, "techniqueID": "T1018", "showSubtechniques": false, "comment": "Kwampirs collects a list of available servers with the command net view.[1]"}, {"techniqueID": "T1218", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1218.011", "showSubtechniques": true, "comment": "Kwampirs uses rundll32.exe in a Registry value added to establish persistence.[1]"}, {"score": 1, "techniqueID": "T1082", "showSubtechniques": false, "comment": "Kwampirs collects OS version information such as registered owner details, manufacturer details, processor type, available storage, installed patches, hostname, version info, system date, and other system information by using the commands systeminfo, net config workstation, hostname, ver, set, and date /t.[1]"}, {"score": 1, "techniqueID": "T1016", "showSubtechniques": false, "comment": "Kwampirs collects network adapter and interface information by using the commands ipconfig /all, arp -a and route print. It also collects the system's MAC address with getmac and domain configuration with net config workstation.[1]"}, {"score": 1, "techniqueID": "T1049", "showSubtechniques": false, "comment": "Kwampirs collects a list of active and listening connections by using the command netstat -nao as well as a list of available network mappings with net use.[1]"}, {"score": 1, "techniqueID": "T1033", "showSubtechniques": false, "comment": "Kwampirs collects registered owner details by using the commands systeminfo and net config workstation.[1]"}, {"score": 1, "techniqueID": "T1007", "showSubtechniques": false, "comment": "Kwampirs collects a list of running services with the command tasklist /svc.[1]"}], "gradient": {"colors": ["#ffffff", "#66b1ff"], "minValue": 0, "maxValue": 1}, "legendItems": [{"label": "used by Kwampirs", "color": "#66b1ff"}]}