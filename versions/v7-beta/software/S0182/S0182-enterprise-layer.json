{"description": "Enterprise techniques used by FinFisher, ATT&CK software S0182 v1.3", "name": "FinFisher (S0182)", "domain": "mitre-enterprise", "version": "3.0", "techniques": [{"techniqueID": "T1548", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1548.002", "showSubtechniques": true, "comment": "FinFisher performs UAC bypass.[1][5]"}, {"techniqueID": "T1134", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1134.001", "showSubtechniques": true, "comment": "FinFisher uses token manipulation with NtFilterToken as part of UAC bypass.[1][5]"}, {"techniqueID": "T1547", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1547.001", "showSubtechniques": true, "comment": "FinFisher establishes persistence by creating the Registry key HKCU\\Software\\Microsoft\\Windows\\Run.[1][5]"}, {"techniqueID": "T1543", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1543.003", "showSubtechniques": true, "comment": "FinFisher creates a new Windows service with the malicious executable for persistence.[1][5]"}, {"score": 1, "techniqueID": "T1140", "showSubtechniques": false, "comment": "FinFisher extracts and decrypts stage 3 malware, which is stored in encrypted resources.[1][5]"}, {"score": 1, "techniqueID": "T1083", "showSubtechniques": false, "comment": "FinFisher enumerates directories and scans for certain files.[1][5]"}, {"techniqueID": "T1574", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1574.001", "showSubtechniques": true, "comment": "A FinFisher variant uses DLL search order hijacking.[1][4]"}, {"score": 1, "techniqueID": "T1574.002", "showSubtechniques": true, "comment": "FinFisher uses DLL side-loading to load malicious programs.[1][5]"}, {"techniqueID": "T1551", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1551.001", "showSubtechniques": true, "comment": "FinFisher clears the system event logs using  OpenEventLog/ClearEventLog APIs .[1][5]"}, {"techniqueID": "T1056", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1056.004", "showSubtechniques": true, "comment": "FinFisher hooks processes by modifying IAT pointers to CreateWindowEx.[1][6]"}, {"techniqueID": "T1036", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1036.005", "showSubtechniques": true, "comment": "FinFisher renames one of its .dll files to uxtheme.dll in an apparent attempt to masquerade as a legitimate file.[1][5]"}, {"score": 1, "techniqueID": "T1027", "showSubtechniques": true, "comment": "FinFisher is heavily obfuscated in many ways, including through the use of spaghetti code in its functions in an effort to confuse disassembly programs. It also uses a custom XOR algorithm to obfuscate code.[1][5]"}, {"score": 1, "techniqueID": "T1027.001", "showSubtechniques": true, "comment": "FinFisher contains junk code in its functions in an effort to confuse disassembly programs.[1][5]"}, {"score": 1, "techniqueID": "T1027.002", "showSubtechniques": true, "comment": "A FinFisher variant uses a custom packer.[1][4]"}, {"techniqueID": "T1542", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1542.003", "showSubtechniques": true, "comment": "Some FinFisher variants incorporate an MBR rootkit.[1][5]"}, {"score": 1, "techniqueID": "T1057", "showSubtechniques": false, "comment": "FinFisher checks its parent process for indications that it is running in a sandbox setup.[1][5]"}, {"techniqueID": "T1055", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1055.001", "showSubtechniques": true, "comment": "FinFisher injects itself into various processes depending on whether it is low integrity or high integrity.[1][5]"}, {"score": 1, "techniqueID": "T1012", "showSubtechniques": false, "comment": "FinFisher queries Registry values as part of its anti-sandbox checks.[1][5]"}, {"score": 1, "techniqueID": "T1113", "showSubtechniques": false, "comment": "FinFisher takes a screenshot of the screen and displays it on top of all other windows for few seconds in an apparent attempt to hide some messages showed by the system during the setup process.[1][5]"}, {"techniqueID": "T1518", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1518.001", "showSubtechniques": true, "comment": "FinFisher probes the system to check for antimalware processes.[1][4]"}, {"score": 1, "techniqueID": "T1082", "showSubtechniques": false, "comment": "FinFisher checks if the victim OS is 32 or 64-bit.[1][5]"}, {"techniqueID": "T1497", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1497.001", "showSubtechniques": true, "comment": "FinFisher obtains the hardware device list and checks if the MD5 of the vendor ID is equal to a predefined list in order to check for sandbox/virtualized environments.[5]"}], "gradient": {"colors": ["#ffffff", "#66b1ff"], "minValue": 0, "maxValue": 1}, "legendItems": [{"label": "used by FinFisher", "color": "#66b1ff"}]}