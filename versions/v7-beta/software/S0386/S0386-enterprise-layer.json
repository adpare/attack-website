{"description": "Enterprise techniques used by Ursnif, ATT&CK software S0386 v1.2", "name": "Ursnif (S0386)", "domain": "mitre-enterprise", "version": "3.0", "techniques": [{"techniqueID": "T1071", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1071.001", "showSubtechniques": true, "comment": "Ursnif has used HTTPS for C2.[3][7][2]"}, {"techniqueID": "T1547", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1547.001", "showSubtechniques": true, "comment": "Ursnif has used Registry Run keys to establish automatic execution at system startup.[6][4]"}, {"score": 1, "techniqueID": "T1059", "showSubtechniques": true, "comment": "Ursnif droppers have used VBA macros to download and execute the malware's full executable payload.[8]"}, {"score": 1, "techniqueID": "T1059.001", "showSubtechniques": true, "comment": "Ursnif droppers have used PowerShell in download cradles to download and execute the malware's full executable payload.[8]"}, {"techniqueID": "T1543", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1543.003", "showSubtechniques": true, "comment": "Ursnif has registered itself as a system service in the Registry for automatic execution at system startup.[6]"}, {"score": 1, "techniqueID": "T1132", "showSubtechniques": false, "comment": "Ursnif has used encoded data in HTTP URLs for C2.[2]    "}, {"score": 1, "techniqueID": "T1005", "showSubtechniques": false, "comment": "Ursnif has collected files from victim machines, including certificates and cookies.[4]"}, {"techniqueID": "T1074", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1074.001", "showSubtechniques": true, "comment": "Ursnif has used tmp files to stage gathered information.[3]"}, {"score": 1, "techniqueID": "T1140", "showSubtechniques": false, "comment": "Ursnif has used crypto key information stored in the Registry to decrypt Tor clients dropped to disk.[2]"}, {"techniqueID": "T1568", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1568.002", "showSubtechniques": true, "comment": "Ursnif has used a DGA to generate domain names for C2.[2]"}, {"score": 1, "techniqueID": "T1041", "showSubtechniques": false, "comment": "Ursnif has used HTTP POSTs to exfil gathered information.[3][7][2]"}, {"techniqueID": "T1564", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1564.003", "showSubtechniques": true, "comment": "Ursnif droppers have used COM properties to execute malware in hidden windows.[8]"}, {"techniqueID": "T1551", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1551.004", "showSubtechniques": true, "comment": "Ursnif has deleted data staged in tmp files after exfiltration.[3]"}, {"score": 1, "techniqueID": "T1105", "showSubtechniques": false, "comment": "Ursnif has dropped payload and configuration files to disk. Ursnif has also been used to download and execute additional payloads.[6][4]"}, {"techniqueID": "T1056", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1056.004", "showSubtechniques": true, "comment": "Ursnif has hooked APIs to perform a wide variety of information theft, such as monitoring traffic from browsers.[3]"}, {"techniqueID": "T1559", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1559.001", "showSubtechniques": true, "comment": "Ursnif droppers have used COM objects to execute the malware's full executable payload.[8]"}, {"score": 1, "techniqueID": "T1185", "showSubtechniques": false, "comment": "Ursnif has injected HTML codes into banking sites to steal sensitive online banking information (ex: usernames and passwords).[4]"}, {"techniqueID": "T1036", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1036.005", "showSubtechniques": true, "comment": "Ursnif has used strings from legitimate system files and existing folders for its file, folder, and Registry entry names.[3]"}, {"score": 1, "techniqueID": "T1112", "showSubtechniques": false, "comment": "Ursnif has used Registry modifications as part of its installation routine.[4][2]"}, {"score": 1, "techniqueID": "T1106", "showSubtechniques": false, "comment": "Ursnif has used CreateProcessW to create child processes.[7]"}, {"score": 1, "techniqueID": "T1027", "showSubtechniques": false, "comment": "Ursnif has used an XOR-based algorithm to encrypt Tor clients dropped to disk.[2]   Ursnif droppers have also been delivered as password-protected zip files that execute base64 encoded PowerShell commands.[8]"}, {"score": 1, "techniqueID": "T1057", "showSubtechniques": false, "comment": "Ursnif has gathered information about running processes.[3][4]"}, {"techniqueID": "T1055", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1055.005", "showSubtechniques": true, "comment": "Ursnif has injected code into target processes via thread local storage callbacks.[3][6][7]"}, {"score": 1, "techniqueID": "T1055.012", "showSubtechniques": true, "comment": "Ursnif has used process hollowing to inject into child processes.[7]"}, {"score": 1, "techniqueID": "T1090", "showSubtechniques": true, "comment": "Ursnif has used a peer-to-peer (P2P) network for C2.[1][2]"}, {"score": 1, "techniqueID": "T1090.003", "showSubtechniques": true, "comment": "Ursnif has used Tor for C2.[1][2]"}, {"score": 1, "techniqueID": "T1012", "showSubtechniques": false, "comment": "Ursnif has used Reg to query the Registry for installed programs.[3][4]"}, {"score": 1, "techniqueID": "T1091", "showSubtechniques": false, "comment": "Ursnif has copied itself to and infected removable drives for propagation.[3][5]"}, {"score": 1, "techniqueID": "T1113", "showSubtechniques": false, "comment": "Ursnif has used hooked APIs to take screenshots.[3][4]"}, {"score": 1, "techniqueID": "T1082", "showSubtechniques": false, "comment": "Ursnif has used Systeminfo to gather system information.[3]"}, {"score": 1, "techniqueID": "T1007", "showSubtechniques": false, "comment": "Ursnif has gathered information about running services.[3]"}, {"score": 1, "techniqueID": "T1080", "showSubtechniques": false, "comment": "Ursnif has copied itself to and infected files in network drives for propagation.[3][5]"}, {"techniqueID": "T1497", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1497.003", "showSubtechniques": true, "comment": "Ursnif has used a 30 minute delay after execution to evade sandbox monitoring tools.[5]"}, {"score": 1, "techniqueID": "T1047", "showSubtechniques": false, "comment": "Ursnif droppers have used WMI classes to execute PowerShell commands.[8]"}], "gradient": {"colors": ["#ffffff", "#66b1ff"], "minValue": 0, "maxValue": 1}, "legendItems": [{"label": "used by Ursnif", "color": "#66b1ff"}]}